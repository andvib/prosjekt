\section{Path}

\subsection{Two Opposite Turns}

How the MPC takes advantage of subsequent opposite turns can be seen in Figure \ref{fig:paths_cur_150m}. When there is an opposite turn trailing the first turn, the optimized path cuts across the line connecting the two turns, while still keeping the camera on the observation path. This is also seen in Figure \ref{fig:paths_cur_heading} that shows the heading angle throughout the turn. The heading angle never reaches $45\degree$ or $70\degree$, because of cutting across the line.

\begin{figure}
	\makebox[\textwidth][c]{
	\subfloat[UAV position $45\degree$]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/paths/fig_cur/uav_position_45deg_150m.eps}}
	\qquad
	\subfloat[UAV position $70\degree$]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/paths/fig_cur/uav_position_70deg_150m.eps}}}
	\makebox[\textwidth][c]{
	\subfloat[Camera position $45\degree$]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/paths/fig_cur/camera_position_45deg_150m.eps}}
	\qquad
	\subfloat[Camera position $70\degree$]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/paths/fig_cur/camera_position_70deg_150m.eps}}}
	\makebox[\textwidth][c]{
	\subfloat[Heading angle]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/paths/fig_cur/heading.eps}
	\label{fig:paths_cur_heading}}}
	\caption{UAV position, camera position and heading angle during two subsequent turns of $45\degree$ and $70\degree$.}
	\label{fig:paths_cur_150m}
\end{figure}


\subsection{Lawnmover Path}

The result of attempting to optimize a lawnmover-pattern path is shown in Figure \ref{fig:lawnmover}. The radius was set to be $250$m, as the optimization of $180\degree$ turn show that the MPC performs well on this turn, and the line connecting two arcs is set to $500$m.

\begin{figure}
	\makebox[\textwidth][c]{
	\subfloat[UAV position]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/lawnmover/fig/uav_position.eps}}
	\qquad
	\subfloat[Camera position]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/lawnmover/fig/camera_position.eps}}}
	\makebox[\textwidth][c]{
	\subfloat[Roll and pitch angle]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/opt/lawnmover/fig/attitude.eps}
	\label{fig:lawnmover_attitude}}}
	\caption{Result of attempting to optimize a lawnmover-pattern path with radius $250$m.}
	\label{fig:lawnmover}
\end{figure}

When the MPC optimizes the first $180\degree$ turn, it performs in a similar manner to the results in section \ref{subsec:180}: it takes the inner turn to begin with, and then widens the turn at the end in order to avoid changing the roll angle quickly. While it should have taken the advantage of the straight line to position the UAV right above the path so it could return to trimmed flight, it instead chooses continue flying next to the path with a constant roll angle to compensate for the offset from the path. It uses the rudder to compensate for the roll angle so it can travel at a constant course angle. The roll angle it uses to track the path while flying next to the path can be seen in Figure \ref{fig:lawnmover_attitude}.

As the UAV approaches the next $180\degree$ arch it is already on the inner side of the turn. However, instead of this being an advantage since it optimizes a $180\degree$ turn like this by taking the inner turn, it throws the UAV into an unstable right-turning spiral.


\subsection{Long Paths}
\label{subsec:long_paths}

In order to test the performance of the MPC over a longer duration, a longer path consisting of several turns was optimized. The path was designed with linear corners that the MPC could handle, and then the curved path was made with similar waypoints and radius of $150$m.

%\begin{figure}
%    \makebox[\textwidth][c]{
%    \includegraphics[width=0.8\textwidth, keepaspectratio=true]{../../results/sim/paths/fig/path.eps}}
%    \caption{The linear and curved paths that will be optimized.}
%    \label{fig:path_easy}
%\end{figure}

\begin{figure}
	\makebox[\textwidth][c]{
	\subfloat[UAV position]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/sim/paths/fig/uav_pos_lin.eps}}
	\qquad
	\subfloat[Camera position]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/sim/paths/fig/camera_pos_lin.eps}}}
    \makebox[\textwidth][c]{
	\subfloat[Attitude angles]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/sim/paths/fig/attitude_lin.eps}
    \label{fig:path_lin_easy_attitude}}}
	\caption{Result of optimizing the piecewise linear path.}
	\label{fig:path_lin_easy}
\end{figure}

\begin{figure}
	\makebox[\textwidth][c]{
	\subfloat[UAV position]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/sim/paths/fig/uav_pos_cur.eps}}
	\qquad
	\subfloat[Camera position]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/sim/paths/fig/camera_pos_cur.eps}}}
    \makebox[\textwidth][c]{
	\subfloat[Attitude angles]{\includegraphics[width=0.5\textwidth, keepaspectratio=true]{../../results/sim/paths/fig/attitude_cur.eps}
    \label{fig:path_cur_easy_attitude}}}
	\caption{Result of optimizing the curved path with a radius of $150$m.}
	\label{fig:path_cur_easy}
\end{figure}

The results of optimizing the longer path can be seen in Figures \ref{fig:path_lin_easy} and \ref{fig:path_cur_easy}. The results of the two optimizations are very similar. At the beginning of the path the MPC chooses to start the turn immediately, which causes the camera to slip out for both the linear and the curved path. The long right turn is in both cases optimized by taking one long, continuous turn, with the camera pointing just beside the ground path.

\begin{table}
\centering
\begin{tabular}{l r r r}
    \hline
    & Mean & Max  & STD \\
    \hline
    Linear path & 6.8390m & 16.8792m & 4.1585m \\
    %\hline
    Curved path & 5.4001m & 14.8386m & 3.7833m \\
    \hline
\end{tabular}
\caption{Mean error, max error and the standard deviation between camera centre point and ground path when tracking the path.}
\label{tab:easy_path}
\end{table}

A difference between the linear and the curved paths can be seen in the roll angle in Figures \ref{fig:path_lin_easy_attitude} and \ref{fig:path_cur_easy_attitude}. The peaks in roll are sharper for the linear path than for the curved path. In Table \ref{tab:easy_path} show that the error between the camera centre point and ground path  for the linear has both a higher max and a higher mean value than for the curved. The standard deviation is also smaller for the curved path, meaning that there are slightly smaller oscillations when tracking the curved path.